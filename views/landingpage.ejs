<%- layout("layouts/boilerplate") %>

<div id="carouselExampleControls" class="carousel slide mb-3" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="https://www.silkrute.com/images/promo/2241/handicraft.webp" class="d-block w-100" alt="...">
      </div>
      <div class="carousel-item">
        <img src="https://www.silkrute.com/images/promo/2241/Beads_and_Block.webp" class="d-block w-100" alt="...">
      </div>
      <div class="carousel-item">
        <img src="https://www.silkrute.com/images/promo/2241/Kitchen.webp" class="d-block w-100" alt="...">
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

    <div class="d-flex justify-content-between mb-2">
        <h3>Highest Rated Products</h1>
            <a href="/products?filter=highestrated" class="btn btn-secondary">View All</a>
    </div>
    <div class="card-group mb-3">
        <% console.log("landing data") %> 
        <% product.sort((a,b)=> a.avgrating-b.avgrating) %>
        <% for(let i=product.length-1; i>=0;i--){ %>
            <% p=product[i] %>
            <% console.log("product",p) %> 
            

                    <div class="col">
                        <div class="card h-100">
                            <img src="<%= p.images[0].url.replace("/upload", "/upload/w_300,h_300" ) %>"
                            class="img-fluid rounded-start img-thumbnail" alt="...">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <%= p.title %>
                                </h5>
                                <p class="card-text">Price: $<%= p.price %>
                                </p>
                                <p class="card-text text-muted">Rating: ‚≠ê<%= p.avgrating.toString().slice(0,3) %>
                                </p>
                                <p>
                                    <% for(let category of p.category){ %>
                                        <a href="/products?category=<%= category %>"
                                            class="btn btn-outline-primary btn-sm">#<%= category.toUpperCase() %> </a>
                                        <% } %>
                                </p>
                            </div>
                            <a href="/products/<%= p._id %>" class="btn btn-primary">View</a>
                        </div>
                    </div>
                    <% } %>
    </div>